function checkTel(e){var t=/^1[3|5|8]\d{9}$/,a=/^0\d{2,3}-?\d{7,8}$/;return t.test(e)||a.test(e)}function globalTouchHandler(e){var e=e||window.event;if(e.touches.length<=1)switch(e.type){case"touchstart":if(/ B/.test(e.target.className))return;console.log(e.target.tagName),e.stopPropagation(),e.preventDefault();var t=e.target;e.target instanceof Element||(t=t.parentNode),globalTouch.startDOM=t,globalTouch.x=e.touches[0].clientX,globalTouch.y=e.touches[0].clientY,globalTouch.dx=0,globalTouch.dy=0,globalTouch.touches=e.touches;break;case"touchmove":globalTouch.dx=e.touches[0].clientX-globalTouch.x,globalTouch.dy=e.touches[0].clientY-globalTouch.y;var a=e.touches;globalTouch.touches=e.touches;break;case"touchend":var t=e.target;(globalTouch.dy<-10||globalTouch.dy>10)&&checkMove(globalTouch.dx,globalTouch.dy,t),globalTouch.dx=null,globalTouch.dy=null}e.touches.length>1}var up=[$(".body .i2")[0],$(".body .i1")[0],$(".result")[0],$(".resultnext")[0],$(".game-end")[0],$(".game-end")[0],$(".game2next .next2")[0],$(".game2next .next1")[0]],down=$(".down");$(document).ready(function(){for(var e=0,t=up.length;t>e;e++)up[e].addEventListener("touchstart",globalTouchHandler,!1),up[e].addEventListener("touchmove",globalTouchHandler,!1),up[e].addEventListener("touchend",globalTouchHandler,!1);$("body>div").removeClass("none"),$(".down").removeClass("none"),$(".pageup").removeClass("none"),fullSel(_p,$(".sel-prov"),"省份"),$(".sel-prov").on("change",fullCity),$(".sel-city").on("change",fullCompany),$(".label").on("click",boxTap),$(".box .sex").on("click",selsex),$(".share-btn").delegate(".b","click",winopen)});var windowReload=function(){window.location.reload()},tapInGoods=function(){var e=$(this),t=parseInt(e.attr("data-s")),a=parseInt(e.attr("data-i"));tapGoods.i--,e.hasClass("visible-hide")||(e.addClass("visible-hide"),game.score-=t,$(".game .content .g"+a).removeClass("off"),e.removeClass("zindex"+tapGoods.i)),$(".game .score").html(game.score+"%")},currZ="";window.ondevicemotion=function(e){$(".game2next").hasClass("hide2")&&(""==currZ&&(currZ=parseInt(e.accelerationIncludingGravity.z)),-7<parseInt(e.accelerationIncludingGravity.z)?$(".next1").hasClass("top")||$(".next1").addClass("top"):$(".next1").hasClass("top")&&$(".next1").removeClass("top"))},window.onscroll=function(){var e=$(window).scrollTop(),t=$(".last-page").height(),a=$("body").height(),n;n=t-a-e,num2=5200,160>n&&(num2=15+.3*n),480>n&&n>160&&(num2=60+1.37*(n-160),num2=num2>1500?1500:num2),820>n&&n>480&&(num2=520+1.3*(n-480),num2=num2>1100?1100:num2),1380>n&&n>820&&(num2=1100+.67*(n-820),num2=num2>1474?1474:num2),1750>n&&n>1380&&(num2=1440+4.7*(n-1380),num2=num2>3196?3196:num2),2030>n&&n>1750&&(num2=3196+5*(n-1750),num2=num2>4600?4600:num2),2765>n&&n>2030&&(num2=4600+.16*(n-2030),num2=num2>4718?4718:num2,num2=4600>num2?4600:num2),3150>n&&n>2765&&(num2=4718-2.77*(n-2765),num2=num2>4718?4718:num2,num2=3650>num2?3650:num2),3650>n&&n>3150&&(num2=3650+4*(n-3150),num2=num2>5200?5200:num2,num2=3650>num2?3650:num2),$(".mark span").html(parseInt(num2)+"m")};var openLastpage=function(){go("last-page"),window.scrollTo(0,5e3)},g1next=function(){g1next.ct=setTimeout(function(){return $(".game .ul")[0].scrollLeft+=10,$(".game .ul")[0].scrollLeft>=$(".game .ul")[0].scrollWidth-$(".game .ul").width()?void clearTimeout(g1next.ct):void g1next()},40)},g1pre=function(){g1pre.ct=setTimeout(function(){return $(".game .ul")[0].scrollLeft-=10,$(".game .ul")[0].scrollLeft<=10?void clearTimeout(g1pre.ct):void g1pre()},40)},winopen=function(e){e.stopPropagation(),e.preventDefault();var t=e.target.getAttribute("data-link");return"weixin"==t?void("undefined"==typeof WeixinJSBridge?alert("请在微信中打开"):go("wx",1)):void window.open(shareObj[t],"_blank")},game2End=function(e){"win"==e?($(".game-end .text img").attr("src","img/wintext2.png"),$(".game-end .btn img").attr("src","img/resultbtn.png"),$(".game-end .btn .b2").attr("onclick","go('form')")):($(".game-end .text img").attr("src","img/losetext2.png"),$(".game-end .btn img").attr("src","img/retrybtn.png"),$(".game-end .btn .b2").attr("onclick","reStartGame2()")),gameText(),go("game-end")},toggleShare=function(){var e=$(this).attr("data-p"),t=$("."+e+" .share-btn");t.hasClass("act")?t.removeClass("act"):t.addClass("act")},submitForm=function(e){if($(".label input")[0].checked&&(!$(".sel-dealer").val()||"经销商"==$(".sel-dealer").val()))return void alert("“经销商*”不能为空！");if(!checkTel($(".mobile").val()))return void alert("手机号格式不正确");if(!$(".name").val()||"请选择"==$(".name").val())return void alert("“姓名*”不能为空！");if(!$(".mobile").val()||"请选择"==$(".mobile").val())return void alert("“手机号*”不能为空！");if(!$(".sel-prov").val()||"省份"==$(".sel-prov").val())return void alert("“省份*”不能为空！");if(!$(".sel-city").val()||"城市"==$(".sel-city").val())return void alert("“城市*”不能为空！");var t="username="+$(".name").val()+"&mobile="+$(".mobile").val()+"&sex="+$('input[name="sex"]').val()+"&province="+$(".sel-prov").val()+"&city="+$(".sel-city").val()+"&dealer="+$(".sel-dealer").val()+"&ystl="+($(".checkbox")[0].checked?"是":"否");$.ajax({url:"/active/join/5",type:"POST",data:$("[name=reg]").serializeArray(),dataType:"json",success:function(e){return alert(200===e.recode?"预约成功":e.reason)}})},selsex=function(){var e=$(".box .sex"),t=$(this);$(".box .sex").removeClass("act"),t.addClass("act"),"先生"==t.html()&&($(".sex-b")[0].checked=!0),"女士"==t.html()&&($(".sex-g")[0].checked=!0)},fullSel=function(e,t,a){for(var n=e,s="<option>"+(a?a:"请选择")+"</option>",o=0,l=n.length;l>o;o++)s+=$.isArray(n[o])?"<option value="+n[o][1]+">"+n[o][0]+"</option>":"<option>"+n[o]+"</option>";t.html(s)},currProvince=null,fullCity=function(e){var t,a=$(this).val(),n=[];if(_pc[a]){currProvince=a,t=_pc[a];for(var s in t)n.push(s);fullSel(n,$(".sel-city"),"城市")}},fullCompany=function(e){var t,a;_pc[currProvince]&&(t=$(this).val(),_pc[currProvince][t]&&(a=_pc[currProvince][t],fullSel(a,$(".sel-dealer"),"经销商")))},boxTap=function(e){var t;t=$("input",this)[0].checked,console.log(t),t?($(this).addClass("act"),$(".sel-dealer").css("background-color","#fff")):($(this).removeClass("act"),$(".sel-dealer").css("background-color","#ccc"))},globalTouch={},checkMove=function(e,t,a){-20>t&&upPage(a),t>20&&downPage(a)},tapDown=function(){var e=$(this),t=e.attr("data-p");console.log(e),/i2/.test(t)&&$(".body .info").addClass("h0"),/i1/.test(t)&&(startGame(),$(".body .info").removeClass("h0")),/result/.test(t)&&go("resultnext"),/resultnext/.test(t)&&go("game2"),/game-end/.test(t)&&go("game2next"),/next2/.test(t)&&($(".game2next").addClass("hide2"),setTimeout(function(){$(".game2next .next2").addClass("opacity")},1400),setTimeout(function(){$(".game2next .next1").css("z-index","1"),$(".game2next .next2").css("z-index","0")},1600)),/next1/.test(t)&&$(".game2next .next1").addClass("top")},upPage=function(e){console.log(e.outerHTML),console.log(e.parentNode);var t=e.parentNode,a=e.parentNode.parentNode,n=e.parentNode.parentNode.parentNode;(/i2/.test(e.className)||/i2/.test(parent.className)||/i2/.test(a.className))&&$(".body .info").addClass("h0"),(/i1/.test(e.className)||/i1/.test(parent.className)||/i1/.test(a.className))&&startGame(),(/result/.test(e.className)||/result/.test(parent.className)||/result/.test(a.className))&&go("resultnext"),(/resultnext/.test(e.className)||/resultnext/.test(parent.className)||/resultnext/.test(a.className))&&go("game2"),(/game-end/.test(e.className)||/game-end/.test(parent.className)||/game-end/.test(a.className))&&go("game2next"),(/next2/.test(e.className)||/next2/.test(parent.className)||/next2/.test(a.className))&&($(".game2next").addClass("hide2"),setTimeout(function(){$(".game2next .next2").addClass("opacity")},1400),setTimeout(function(){$(".game2next .next1").css("z-index","1"),$(".game2next .next2").css("z-index","0")},1600)),(/next1/.test(e.className)||/next1/.test(parent.className)||/next1/.test(a.className))&&$(".game2next .next1").addClass("top")},downPage=function(e){console.log(e.outerHTML),console.log(e.parentNode);var t=e.parentNode,a=e.parentNode.parentNode,n=e.parentNode.parentNode.parentNode;(/i1/.test(e.className)||/i1/.test(parent.className)||/i1/.test(a.className))&&$(".body .info").removeClass("h0"),(/result/.test(e.className)||/result/.test(parent.className)||/result/.test(a.className))&&go("body"),(/resultnext/.test(e.className)||/resultnext/.test(parent.className)||/resultnext/.test(a.className))&&go("result"),(/game-end/.test(e.className)||/game-end/.test(parent.className)||/game-end/.test(a.className))&&go("resultnext"),(/next2/.test(e.className)||/next2/.test(parent.className)||/next2/.test(a.className))&&go("game-end")},page=$("body>div"),currPage=["body"],go=function(e,t){return console.log(currPage),t||page.addClass("hide"),e?($("."+e).removeClass("hide"),currPage.push(e),void window.scrollTo(0,1)):($("."+currPage[currPage.length-2]).removeClass("hide"),currPage.push(currPage[currPage.length-2]),void window.scrollTo(0,1))};